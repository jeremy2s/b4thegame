services:
  - type: web
    name: b4thegame
    env: node
    # Build the API + the client bundle, then serve everything from the Node service.
    # `--include=dev` ensures build tooling (vite, etc.) is installed during the build step.
    buildCommand: cd server && npm ci --include=dev && cd ../client && npm ci --include=dev && npm run build
    startCommand: cd server && npm start
    healthCheckPath: /api/health
    envVars:
      - key: NODE_VERSION
        value: 20.19.6
